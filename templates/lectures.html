{% extends "base.html" %}

<!-- Pang override ng original style ng button para mapalitan nung nilagay ko -->
{% block styles %}
  <style>
    #btn-create-post {
      background-color: #026ffd; color: white; padding: 10px 20px;
      border: none; border-radius: 8px; cursor: pointer;
      font-size: 16px;
    }

    #btn-create-post:hover {
      transform: translateY(-1px); background-color: #0056b3; transition: transform 0.8s ease,
    } 
  </style>
{% endblock styles %}

{% block title %}Lectures | DSAWebLectures{% endblock %}

{% block content %}
<main class="lectures-page">
  <section class="lectures-header">
    <button id="btn-create-post" aria-haspopup="dialog">Create a Post</button>
  </section>

  <!-- Posts Feed -->
  <section id="posts-list" aria-live="polite">
    {% for post in posts %}
    <article class="post-card" data-id="{{ post.id }}">
      <header>
        <h3 class="post-title">{{ post.title }}</h3>
    <div class="three-dots" data-id="{{ post.id }}" tabindex="0" role="button" aria-label="Post menu">‚ãØ</div>

    <!-- Dropdown Menu -->
    <div class="dropdown-menu" id="menu-{{ post.id }}">
      <button class="edit-post" data-id="{{ post.id }}">‚úèÔ∏è Edit</button>
      <button class="delete-post" data-id="{{ post.id }}">üóëÔ∏è Delete</button>
        </div>
      </header>

      <div class="post-body">
        <p>{{ post.caption }}</p>
        {% if post.file_url %}
          {% if post.file_mime.startswith('image/') %}
            <img src="{{ post.file_url }}" alt="Post image" class="post-media" />
          {% elif post.file_mime == 'application/pdf' %}
            <iframe src="{{ post.file_url }}" class="post-media pdf-viewer"></iframe>
          {% else %}
            <a href="{{ post.file_url }}" download>Download attachment</a>
          {% endif %}
        {% endif %}
      </div>

      <footer>
        <button class="vote-up" data-id="{{ post.id }}">‚ñ≤ <span class="count">{{ post.upvotes }}</span></button>
        <button class="vote-down" data-id="{{ post.id }}">‚ñº <span class="count">{{ post.downvotes }}</span></button>
        <button class="comment-toggle" data-id="{{ post.id }}">üí¨ Comments</button>
      </footer>

      <section class="comments" data-id="{{ post.id }}" style="display:none">
        <div class="comments-list"></div>
        <textarea class="comment-input" placeholder="Add a comment..." aria-label="Comment input"></textarea>
        <button class="comment-send">Send</button>
      </section>
    </article>
    {% else %}
    <p class="no-posts">No posts yet. Be the first to create one!</p>
    {% endfor %}
  </section>

  <div class="load-more-container">
    <button id="load-more">Load More</button>
  </div>
</main>

<!-- Post Modal -->
<div id="post-modal" class="modal" role="dialog" aria-hidden="true" aria-labelledby="modal-title">
  <div class="modal-content">
    <h2 id="modal-title">Create a Post</h2>
    <form id="post-form" enctype="multipart/form-data">
      <input type="hidden" id="edit-post-id" value="" />
      <label for="post-title">Title:</label>
      <input type="text" name="title" id="post-title" required />

      <label for="post-caption">Caption:</label>
      <textarea name="caption" id="post-caption" required></textarea>

      <label for="post-file">Attachment (optional):</label>
      <input type="file" name="file" id="post-file" class="input-file"/> <!-- tinago ko ung original input area para malagyan css -->
      <label for="post-file" id="button">Choose File</label> <!-- section changed, sineparate ko para malagyan css -->

      <label for="post-author">Author:</label>
      <input type="text" name="author" id="post-author" required />

      <div class="modal-actions">
        <button type="button" id="post-publish">Publish</button>
        <button type="button" id="post-cancel">Cancel</button>
      </div>
    </form>
  </div>
</div>

<!-- Snackbar for delete confirmation -->
<div id="snackbar" class="snackbar" aria-live="assertive" style="display:none;">
  <span id="snackbar-msg">Post deleted. Undo?</span>
  <button id="snackbar-cancel">Undo</button>
</div>

<footer class="footer">
  <p>&copy; {{ current_year or 2025 }} DSAWebLectures</p>
</footer>

<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
